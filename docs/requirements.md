# 要件定義書

## プロジェクト概要
**プロジェクト名**: 教師対生徒の面接練習レポート支援ツール

**目的**: 教師と生徒の面接練習を録音し、音声分析・文字起こし・音声特性評価を行い、面接パフォーマンスの改善に役立つレポートを生成する。

**対象ユーザー**: 
- 教師(面接官役)
- 生徒(面接練習者)
- 教育機関

---

## 機能要件

### 1. 音声録音機能
**概要**: 面接練習の音声を録音する

#### 1.1 録音開始・停止
- **要件ID**: REQ-001
- **優先度**: 高
- **詳細**:
  - ユーザーが録音の開始・停止を操作できる
  - 録音ファイルの保存形式: WAV または MP3
  - 録音品質: 最低16kHz サンプリングレート

#### 1.2 録音データの保存
- **要件ID**: REQ-002
- **優先度**: 高
- **詳細**:
  - 録音データをローカルまたはクラウドストレージに保存
  - ファイル命名規則: `interview_YYYYMMDD_HHMMSS.wav`
  - メタデータ(日時、参加者、長さ)の記録

---

### 2. 話者分離機能
**概要**: 録音された音声から教師と生徒の音声を分離する

#### 2.1 話者識別
- **要件ID**: REQ-003
- **優先度**: 高
- **詳細**:
  - 2人の話者(教師/生徒)を自動識別
  - 各発話に話者ラベルを付与
  - 話者分離精度: 85%以上を目標

#### 2.2 話者分離アルゴリズム
- **要件ID**: REQ-004
- **優先度**: 中
- **詳細**:
  - pyannote.audio または類似ライブラリを使用
  - リアルタイム処理または後処理の選択可能

---

### 3. 文字起こし機能
**概要**: 話者分離された音声を文字に変換する

#### 3.1 音声認識
- **要件ID**: REQ-005
- **優先度**: 高
- **詳細**:
  - **無料で使える音声認識エンジン**:
    - **OpenAI Whisper**(推奨): 完全無料、ローカル実行可能、日本語精度が高い
    - **Vosk**: オフライン対応、軽量、無料
    - **SpeechRecognition + Google Web Speech API**: 制限付き無料
  - 話者ごとに文字起こし結果を分離
  - 文字起こし精度: 85%以上を目標(無料ツール使用のため)

#### 3.2 タイムスタンプ付与
- **要件ID**: REQ-006
- **優先度**: 中
- **詳細**:
  - 各発話に開始・終了時刻を記録
  - 出力形式: JSON または SRT形式

---

### 4. 日本語補正機能
**概要**: Gemini APIを使用して文字起こしデータの日本語を補正する

#### 4.1 文法・表現の補正
- **要件ID**: REQ-007
- **優先度**: 高
- **詳細**:
  - **Ollama + Llama3/Gemma**(完全無料、ローカル実行)で文字起こしテキストを補正
  - 誤字脱字、文法ミス、不自然な表現を修正
  - 元のテキストと補正後テキストを両方保持
  - インターネット接続不要

#### 4.2 敬語・ビジネス表現のチェック
- **要件ID**: REQ-008
- **優先度**: 中
- **詳細**:
  - 面接に適した敬語使用の評価
  - 不適切な表現の検出と改善提案
  - フィードバックレポートの生成

---

### 5. 声色分析機能
**概要**: 音声の特性を分析し、面接に適した声かどうかを評価する

#### 5.1 基本音声特性の分析
- **要件ID**: REQ-009
- **優先度**: 高
- **詳細**:
  - 参考: https://voicemind.net/
  - 分析項目:
    - ピッチ(音の高さ)
    - 音量(声の大きさ)
    - 話速(1分あたりの文字数)
    - 声のトーン(明るさ/暗さ)

#### 5.2 感情・印象分析
- **要件ID**: REQ-010
- **優先度**: 中
- **詳細**:
  - 声から感じられる感情(自信、緊張、明るさなど)を推定
  - 聞き手に与える印象の評価
  - 分析結果のスコアリング(0-100点)

#### 5.3 面接適正評価
- **要件ID**: REQ-011
- **優先度**: 中
- **詳細**:
  - 面接に適した声の特性との比較
  - 改善ポイントの提示
  - 良かった点の強調

---

### 6. レポート生成機能
**概要**: 分析結果を統合してレポートを生成する

#### 6.1 総合レポート作成
- **要件ID**: REQ-012
- **優先度**: 高
- **詳細**:
  - 文字起こし結果
  - 日本語補正結果
  - 音声分析結果
  - 総合評価とフィードバック
  - 出力形式: PDF、HTML、Markdown

#### 6.2 視覚化
- **要件ID**: REQ-013
- **優先度**: 中
- **詳細**:
  - グラフやチャートによる分析結果の可視化
  - 話者ごとの発話時間比率
  - 音声特性の推移グラフ

---

## 非機能要件

### 7. パフォーマンス
- **要件ID**: NFR-001
- **詳細**:
  - 10分間の録音音声を10分以内に処理完了(ローカル実行のため)
  - Whisperモデルサイズによる処理時間の調整可能
  - 外部API呼び出しのタイムアウト処理

### 8. セキュリティ
- **要件ID**: NFR-002
- **詳細**:
  - 録音データの暗号化保存(ローカルのみ)
  - HuggingFace トークンの安全な管理(.env ファイル使用)
  - 完全ローカル実行でデータ外部送信なし
  - 個人情報保護に配慮

### 9. ユーザビリティ
- **要件ID**: NFR-003
- **詳細**:
  - 直感的なUI/UX
  - エラーメッセージの分かりやすい表示
  - 処理状況のプログレス表示

### 10. 拡張性
- **要件ID**: NFR-004
- **詳細**:
  - モジュール化された設計
  - 新しい分析機能の追加が容易
  - 複数の音声認識エンジンへの対応可能性

---

## 技術スタック(案)

### バックエンド
- **言語**: Python 3.9+
- **フレームワーク**: FastAPI または Flask
- **音声処理**: 
  - **OpenAI Whisper**(音声認識) - 完全無料、ローカル実行
    - 推奨モデル: base(高速) または small(バランス型)
  - **pyannote.audio**(話者分離) - 無料、HuggingFaceトークンで使用
  - **librosa, pydub**(音声分析) - 完全無料
- **AI/LLM**: 
  - **Ollama + Llama3.2 または Gemma2**(完全無料、ローカル実行)
  - インターネット接続不要、API料金ゼロ

### フロントエンド
- **フレームワーク**: React, Vue.js または シンプルなHTML/CSS/JavaScript
- **録音**: Web Audio API または RecordRTC

### データベース
- **データ保存**: SQLite(完全無料、ローカル)
- **ファイルストレージ**: ローカルストレージのみ

### デプロイ
- **環境**: ローカル実行(Windows/Mac/Linux)
- **仮想化**: Docker(オプション)
- **完全オフライン動作可能**

---

## 開発フェーズ

### フェーズ1: 基本機能実装(MVP)
- 録音機能
- 文字起こし機能
- 基本的なレポート出力

### フェーズ2: AI機能統合
- Gemini APIによる日本語補正
- 話者分離の実装

### フェーズ3: 音声分析機能
- 声色分析
- 面接適正評価

### フェーズ4: UI/UX改善・最適化
- レポートの視覚化
- パフォーマンス最適化
- ユーザーフィードバック反映

---

## 制約事項・前提条件

1. **初回のみインターネット接続が必要**(Whisper、Ollama、pyannoteモデルのダウンロード)
2. マイクデバイスへのアクセス許可が必要
3. 録音時間に応じた処理時間が発生(ローカル実行のため)
4. **推奨スペック**:
   - CPU: 4コア以上(8コア推奨)
   - RAM: 8GB以上(16GB推奨)
   - ストレージ: 10GB以上の空き容量
   - GPU: オプション(CUDA対応GPUで高速化可能)
5. **完全無料、API料金ゼロ**

---

## 成功基準

- 文字起こし精度 85%以上(Whisper使用)
- 話者分離精度 80%以上(pyannote.audio使用)
- 処理時間: 録音時間の100%以内(ローカル実行)
- ユーザー満足度調査で4/5点以上
- **完全無料での運用を実現**

---

## リスクと対策

| リスク | 影響度 | 対策 |
|--------|--------|------|
| 処理時間の長期化 | 中 | Whisperモデルサイズ調整、非同期処理、進捗表示 |
| 音声認識精度の低下 | 中 | Whisperモデルサイズup、前処理改善 |
| 個人情報漏洩 | 高 | 完全ローカル実行、暗号化、アクセス制御 |
| GPUメモリ不足 | 低 | CPUモード実行、小モデル使用 |

---

**作成日**: 2025年12月9日  
**バージョン**: 1.0  
**作成者**: GitHub Copilot
